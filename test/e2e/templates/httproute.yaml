apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: {{ .HTTPRouteName }}
  namespace: {{ .EnvoyGatewayNamespace }}
spec:
  parentRefs:
  - name: {{ .GatewayName }}
    namespace: {{ .EnvoyGatewayNamespace }}
  rules:
  - matches:
    - path:
        type: PathPrefix
        value: {{ .HTTPRoutePathPrefix }}
    backendRefs:
{{- if .BackendRefs }}
{{- range .BackendRefs }}
    - group: {{ .Group }}
      kind: {{ .Kind }}
      name: {{ .Name }}
      namespace: {{ .Namespace }}
      {{- if .Weight }}
      weight: {{ .Weight }}
      {{- end }}
{{- end }}
{{- else }}
    - group: {{ .XdsBackendGroup }}
      kind: {{ .XdsBackendKind }}
      name: {{ .XdsBackendResourceName }}
{{- end }}

