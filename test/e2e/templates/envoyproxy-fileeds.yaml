apiVersion: gateway.envoyproxy.io/v1alpha1
kind: EnvoyProxy
metadata:
  name: {{ .GatewayClassName }}
  namespace: {{ .EnvoyGatewayNamespace }}
spec:
  provider:
    type: Kubernetes
    kubernetes:
      envoyDeployment:
        container:
          volumeMounts:
          - mountPath: /etc/envoy/eds
            name: eds
            readOnly: true
        pod:
          volumes:
          - name: eds
            configMap:
              name: {{ .EdsConfigMapName }}
  bootstrap:
    type: Merge
    value: |
      static_resources:
        clusters:
        - name: {{ .FileEdsClusterName }}
          type: STRICT_DNS
          connect_timeout: 5s
          load_assignment:
            cluster_name: {{ .FileEdsClusterName }}
            endpoints:
            - lb_endpoints:
              - endpoint:
                  address:
                    socket_address:
                      address: {{ .FileEdsServiceFQDN }}
                      port_value: {{ .FileEdsPort }}
          http2_protocol_options: {}

