apiVersion: gateway.envoyproxy.io/v1alpha1
kind: EnvoyProxy
metadata:
  name: {{ .GatewayClassName }}
  namespace: {{ .EnvoyGatewayNamespace }}
spec:
  provider:
    type: Kubernetes
    kubernetes:
      envoyDeployment:
        container:
          volumeMounts:
          - mountPath: /etc/envoy/xds
            name: envoy-eds-config
            readOnly: true
        pod:
          volumes:
          - name: envoy-eds-config
            configMap:
              name: {{ .EnvoyEdsConfigMapName }}
  bootstrap:
    type: Merge
    value: |
      static_resources:
        clusters:
        - name: {{ .FileXdsClusterName }}
          type: STRICT_DNS
          connect_timeout: 5s
          load_assignment:
            cluster_name: {{ .FileXdsClusterName }}
            endpoints:
            - lb_endpoints:
              - endpoint:
                  address:
                    socket_address:
                      address: {{ .FileXdsServiceFQDN }}
                      port_value: {{ .FileXdsPort }}
          http2_protocol_options: {}